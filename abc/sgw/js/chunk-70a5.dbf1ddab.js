(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-70a5"],{"147a":function(e,t,a){"use strict";var i=a("474c");a.n(i).a},"474c":function(e,t,a){},"5ef9":function(e,t,a){"use strict";a("7f7f"),a("ac6a");var i=a("313e"),r=a.n(i),n={props:{title:String,chartData:Object},data:function(){return{chart:void 0}},methods:{renderChart:function(){var t=[];this.chartData.series&&0<this.chartData.series.length&&this.chartData.series.forEach(function(e){t.push(e.name)});var e=this.chartData.columns?this.chartData.columns:[],a=this.chartData.series?this.chartData.series:[];a.forEach(function(e){return e.type="bar"}),this.chart=r.a.init(document.querySelector("#echartsBar")),this.chart.setOption({tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{top:10,left:"center",data:t},xAxis:{type:"category",data:e},yAxis:{type:"value"},series:a})}},watch:{chartData:{handler:function(e,t){var a=this;this.$nextTick(function(){a.renderChart()})},deep:!0}},mounted:function(){this.renderChart()}},l=a("2877"),o=Object(l.a)(n,function(){var e=this.$createElement;return(this._self._c||e)("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"echartsBar"}})},[],!1,null,null,null);o.options.__file="BarModal.vue";t.a=o.exports},"758b":function(e,r,n){"use strict";(function(e){n("7f7f"),n("7514");var t=n("5ef9"),a=n("dd2c"),i=n("c276"),o=n("948c");r.a={name:"LoggerFlow",components:{BarModal:t.a,LineModal:a.a},mixins:[],data:function(){return{filename:e,pickerOptionsDay:{disabledDate:function(e){return e.getTime()>(new Date).getTime()||e.getTime()<new Date("2017/01/01").getTime()},onPick:function(e){var t=e.maxDate,a=e.minDate;2592e6<t-a&&(this.$message({message:"日期跨度不能超过".concat(31,"天"),type:"warning"}),a.setTime(null),t.setTime(null))}},barFilter:{date:[]},barData:{},lineFilter:{queryDate:"",type:"hour",domain:"",entry:""},lineData:{},tableFilter:{fromTime:"",toTime:""},tableData:[],dialogVisible:!1,tableDetailData:[],dialogCurrentPage:1,dialogPageSize:10,dialogTotalCount:0,currentIP:"",barLoading:!1,lineLoading:!1,tableLoading:!1,dialogTableLoading:!1}},computed:{domainList:function(){return this.$store.getters["logger/filter/domainList"]},entryList:function(){var t=this,e=this.domainList.find(function(e){return e.name===t.lineFilter.domain});return e?e.data:[]}},created:function(){this.$store.dispatch("logger/filter/getDomainEntryMapping")},mounted:function(){this.initDate(),this.renderBarChart(),this.renderLineChart()},watch:{},methods:{initDate:function(){this.barFilter.date.push(i.a.date.getCurrentMonth()+"-01"),this.barFilter.date.push(i.a.date.formatDate((new Date).getTime(),"yyyy-MM-dd")),this.lineFilter.queryDate=i.a.date.formatDate((new Date).getTime(),"yyyy-MM-dd")},renderBarChart:function(){var t=this,e={fromDate:this.barFilter.date[0],toDate:this.barFilter.date[1]};this.barLoading=!0,Object(o.h)(e).then(function(e){t.barLoading=!1,t.barData=e}).catch(function(e){t.barLoading=!1,t.$message.error(e.msg)})},renderLineChart:function(){var t=this;this.lineLoading=!0;var e=this.lineFilter,a={queryDate:e.queryDate,type:e.type,domain:e.domain,entry:e.entry};Object(o.i)(a).then(function(e){t.lineLoading=!1,t.lineData=e}).catch(function(e){t.lineLoading=!1,t.$message.error(e.msg)}),this.tableFilter.fromTime="",this.tableFilter.toTime="",this.tableData=[]},renderTable:function(){var t=this;this.tableLoading=!0;var e=this.lineFilter,a=e.queryDate,i=e.domain,r=e.entry,n=this.tableFilter,l={queryDate:a,domain:i,entry:r,fromTime:n.fromTime,toTime:n.toTime};Object(o.j)(l).then(function(e){t.tableLoading=!1,t.tableData=e}).catch(function(e){t.tableLoading=!1,t.$message.error(e.msg)})},renderIPDetail:function(){var t=this;this.dialogTableLoading=!0;var e=this.lineFilter,a=e.queryDate,i=e.domain,r=e.entry,n=this.tableFilter,l={queryDate:a,domain:i,entry:r,fromTime:n.fromTime,toTime:n.toTime,reqIp:this.currentIP,pageIndex:this.dialogCurrentPage,pageSize:this.dialogPageSize};Object(o.k)(l).then(function(e){t.dialogTableLoading=!1,t.tableDetailData=e.list,t.dialogTotalCount=e.totalCount}).catch(function(e){t.loading=!1,t.$message.error(e.msg)})},handleBarDateChange:function(){this.renderBarChart()},handleLineDateSearch:function(){this.renderLineChart()},handleDomainChange:function(){this.lineFilter.entry=""},handleTableDataSearch:function(){if(""===this.tableFilter.fromTime||""===this.tableFilter.toTime)return this.$message({message:"请选择时段",type:"warning"}),!1;this.renderTable()},handleShowDetail:function(e){this.dialogVisible=!0,this.currentIP=e.reqIp,this.renderIPDetail()},dialogCloseCallback:function(){this.currentIP="",this.tableDetailData=[],this.dialogTotalCount=0},handleDialogCurrentChange:function(){this.renderIPDetail()}},filters:{numberFormat:function(e){return i.a.number.format(e)}}}}).call(this,"src\\pages\\logger-report\\flow\\index.vue?vue&type=script&lang=js&")},a569:function(e,t,a){"use strict";a.r(t);var i=a("758b").a,r=(a("147a"),a("2877")),n=Object(r.a)(i,function(){var a=this,e=a.$createElement,i=a._self._c||e;return i("d2-container",{attrs:{filename:a.filename}},[i("template",{slot:"header"},[i("mg-breadcrumb")],1),i("div",{staticClass:"page-container d2-clearfix report-slider"},[i("div",{staticClass:"section-container"},[i("el-form",{ref:"formFilter",staticClass:"filter-container",attrs:{inline:!0,model:a.barFilter,size:"small"},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",{attrs:{label:"查询时间"}},[i("el-date-picker",{attrs:{size:"medium",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",editable:!1,clearable:!1,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":a.pickerOptionsDay},on:{change:a.handleBarDateChange},model:{value:a.barFilter.date,callback:function(e){a.$set(a.barFilter,"date",e)},expression:"barFilter.date"}})],1)],1),i("bar-modal",{directives:[{name:"loading",rawName:"v-loading",value:a.barLoading,expression:"barLoading"}],attrs:{chartData:a.barData,"element-loading-text":"数据加载中..."}})],1),i("div",{staticClass:"section-container"},[i("el-form",{ref:"formFilter",staticClass:"filter-container",attrs:{inline:!0,model:a.lineFilter,size:"small"},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",{attrs:{label:"查询日期"}},[i("el-date-picker",{attrs:{size:"medium",type:"date",placeholder:"选择日期",editable:!1,clearable:!1,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":a.pickerOptionsDay},model:{value:a.lineFilter.queryDate,callback:function(e){a.$set(a.lineFilter,"queryDate",e)},expression:"lineFilter.queryDate"}})],1),i("el-form-item",{attrs:{label:"查询粒度"}},[i("el-radio-group",{model:{value:a.lineFilter.type,callback:function(e){a.$set(a.lineFilter,"type",e)},expression:"lineFilter.type"}},[i("el-radio-button",{attrs:{label:"hour"}},[a._v("小时")]),i("el-radio-button",{attrs:{label:"minute"}},[a._v("分钟")])],1)],1),i("el-form-item",{attrs:{label:"域"}},[i("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择域名",clearable:""},on:{change:a.handleDomainChange},model:{value:a.lineFilter.domain,callback:function(e){a.$set(a.lineFilter,"domain",e)},expression:"lineFilter.domain"}},a._l(a.domainList,function(e){return i("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}))],1),i("el-form-item",{attrs:{label:"入口"}},[i("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择入口",clearable:""},model:{value:a.lineFilter.entry,callback:function(e){a.$set(a.lineFilter,"entry",e)},expression:"lineFilter.entry"}},a._l(a.entryList,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})}))],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",loading:a.lineLoading},on:{click:a.handleLineDateSearch}},[a._v("查询")])],1)],1),i("line-modal",{directives:[{name:"loading",rawName:"v-loading",value:a.lineLoading,expression:"lineLoading"}],attrs:{chartData:a.lineData,type:a.lineFilter.type,"element-loading-text":"数据加载中..."}})],1),i("div",{staticClass:"section-container"},[i("h2",[a._v("访问量Top10的IP")]),i("el-form",{ref:"formFilter",staticClass:"filter-container",attrs:{inline:!0,model:a.tableFilter,size:"small"},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",{attrs:{label:"激增时段"}},[i("el-time-select",{staticStyle:{width:"130px","margin-right":"10px"},attrs:{placeholder:"起始时间","picker-options":{start:"00:00",step:"00:05",end:"23:55"}},model:{value:a.tableFilter.fromTime,callback:function(e){a.$set(a.tableFilter,"fromTime",e)},expression:"tableFilter.fromTime"}}),i("el-time-select",{staticStyle:{width:"130px"},attrs:{placeholder:"结束时间","picker-options":{start:"00:00",step:"00:05",end:"23:55",minTime:a.tableFilter.fromTime}},model:{value:a.tableFilter.toTime,callback:function(e){a.$set(a.tableFilter,"toTime",e)},expression:"tableFilter.toTime"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",loading:a.tableLoading},on:{click:a.handleTableDataSearch}},[a._v("查询")])],1)],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.tableLoading,expression:"tableLoading"}],attrs:{data:a.tableData,"element-loading-text":"数据加载中...",stripe:""}},[i("el-table-column",{attrs:{width:"5"}}),i("el-table-column",{attrs:{prop:"section",label:"时段"}}),i("el-table-column",{attrs:{prop:"reqIp",label:"访问ip"}}),i("el-table-column",{attrs:{prop:"reqTotal",label:"访问量"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n                        "+a._s(a._f("numberFormat")(e.row.reqTotal))+"\n                    ")]}}])}),i("el-table-column",{attrs:{prop:"hitRules",label:"触碰规则量"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n                        "+a._s(a._f("numberFormat")(e.row.hitRules))+"\n                    ")]}}])}),i("el-table-column",{attrs:{label:"操作",width:"105"},scopedSlots:a._u([{key:"default",fn:function(t){return[i("a",{staticClass:"handle-btn",on:{click:function(e){a.handleShowDetail(t.row)}}},[a._v("查看详情")])]}}])})],1)],1)]),i("el-dialog",{attrs:{title:"IP详情（"+a.currentIP+"）",visible:a.dialogVisible,width:"1000px"},on:{"update:visible":function(e){a.dialogVisible=e},close:a.dialogCloseCallback}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.dialogTableLoading,expression:"dialogTableLoading"}],attrs:{data:a.tableDetailData,"element-loading-text":"数据加载中...",stripe:""}},[i("el-table-column",{attrs:{width:"5"}}),i("el-table-column",{attrs:{prop:"reqIp",label:"ip",width:"140"}}),i("el-table-column",{attrs:{prop:"host",label:"host"}}),i("el-table-column",{attrs:{prop:"path",label:"path"}}),i("el-table-column",{attrs:{prop:"userAgent",label:"userAgent",width:"120"}}),i("el-table-column",{attrs:{prop:"canvasId",label:"canvasId",width:"100"}}),i("el-table-column",{attrs:{prop:"accessDate",label:"accessTime",width:"180"}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:0<a.tableDetailData.length,expression:"tableDetailData.length > 0"}],staticClass:"pagination-wrap"},[i("span",[a._v("第 "+a._s(a.dialogCurrentPage)+" 页")]),i("el-pagination",{staticClass:"fieldlist-pagination",attrs:{"current-page":a.dialogCurrentPage,"page-size":a.dialogPageSize,total:a.dialogTotalCount,layout:"prev, next"},on:{"update:currentPage":function(e){a.dialogCurrentPage=e},"current-change":a.handleDialogCurrentChange}})],1)],1)],2)},[],!1,null,"0e083c3e",null);n.options.__file="index.vue";t.default=n.exports},dd2c:function(e,t,a){"use strict";a("7f7f"),a("ac6a");var i=a("313e"),r=a.n(i),n={props:{type:String,chartData:Object},data:function(){return{chart:void 0}},methods:{renderChart:function(){var t=[];this.chartData.series&&0<this.chartData.series.length&&this.chartData.series.forEach(function(e){t.push(e.name)});var e=this.chartData.columns?this.chartData.columns:[],a=this.chartData.series?this.chartData.series:[];a.forEach(function(e){return e.type="line"}),this.chart=r.a.init(document.querySelector("#echartsLine")),this.chart.setOption({tooltip:{trigger:"axis"},legend:{top:10,left:"center",data:t},xAxis:{type:"category",boundaryGap:!1,data:e},yAxis:{type:"value"},dataZoom:"hour"===this.type?[{show:!1,realtime:!1,start:0,end:100}]:[{show:!0,realtime:!0,start:0,end:30}],series:a})}},watch:{chartData:{handler:function(e,t){var a=this;this.$nextTick(function(){a.renderChart()})},deep:!0}},mounted:function(){this.renderChart()}},l=a("2877"),o=Object(l.a)(n,function(){var e=this.$createElement;return(this._self._c||e)("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"echartsLine"}})},[],!1,null,null,null);o.options.__file="LineModal.vue";t.a=o.exports}}]);